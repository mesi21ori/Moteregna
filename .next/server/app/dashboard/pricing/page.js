(()=>{var e={};e.id=9863,e.ids=[9863],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84007:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>o}),t(88738),t(13321),t(36710),t(35866);var s=t(23191),r=t(88716),i=t(37922),n=t.n(i),l=t(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(a,d);let o=["",{children:["dashboard",{children:["pricing",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,88738)),"C:\\Users\\hp\\Desktop\\gibemarket\\Moteregna\\new\\Moteregna\\app\\dashboard\\pricing\\page.tsx"]}]},{loading:[()=>Promise.resolve().then(t.bind(t,24911)),"C:\\Users\\hp\\Desktop\\gibemarket\\Moteregna\\new\\Moteregna\\app\\dashboard\\pricing\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"C:\\Users\\hp\\Desktop\\gibemarket\\Moteregna\\new\\Moteregna\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,36710)),"C:\\Users\\hp\\Desktop\\gibemarket\\Moteregna\\new\\Moteregna\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\hp\\Desktop\\gibemarket\\Moteregna\\new\\Moteregna\\app\\dashboard\\pricing\\page.tsx"],p="/dashboard/pricing/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/pricing/page",pathname:"/dashboard/pricing",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},67479:(e,a,t)=>{Promise.resolve().then(t.bind(t,79168))},79168:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>f});var s=t(10326),r=t(17577),i=t(90772),n=t(33071),l=t(54432),d=t(15940),o=t(62288),c=t(92397),p=t(567),u=t(88307),m=t(79635),x=t(69508),g=t(35047),h=t(85999);function f(){let e=(0,g.useRouter)(),[a,t]=(0,r.useState)(""),[f,j]=(0,r.useState)(!1),[b,y]=(0,r.useState)(null),[v,N]=(0,r.useState)(""),[w,P]=(0,r.useState)(""),[k,C]=(0,r.useState)([]),[S,M]=(0,r.useState)(!0),[_,D]=(0,r.useState)({page:1,limit:10,total:0,totalPages:1}),z=async()=>{try{M(!0);let e=await fetch(`/api/prices/history?page=${_.page}&limit=${_.limit}&search=${a}`,{credentials:"include"});if(!e.ok)throw Error("Failed to fetch pricing data");let{data:t,pagination:s}=await e.json();C(t),D(s)}catch(a){h.Am.error(a instanceof Error?a.message:"Failed to load pricing data"),a instanceof Error&&a.message.includes("Unauthorized")&&e.push("/signin")}finally{M(!1)}},E=e=>{D(a=>({...a,page:e}))},Z=e=>{y(e),N(e.basePrice.toString()),P(e.perKmPrice.toString()),j(!0)},A=async()=>{if(b)try{if(!(await fetch("/api/prices",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({basePrice:Number(v),perKmPrice:Number(w)})})).ok)throw Error("Failed to update pricing");h.Am.success("Pricing updated successfully"),z(),j(!1)}catch(e){h.Am.error(e instanceof Error?e.message:"Failed to update pricing")}},B=k.filter(e=>e.updatedBy.toLowerCase().includes(a.toLowerCase()));return S&&0===k.length?s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Pricing History"}),(0,s.jsxs)("div",{className:"relative w-full sm:w-64",children:[s.jsx(u.Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),s.jsx(l.I,{placeholder:"Search by updated by...",className:"pl-8",value:a,onChange:e=>{t(e.target.value),D(e=>({...e,page:1}))}})]})]}),(0,s.jsxs)(n.Zb,{children:[(0,s.jsxs)(n.Ol,{children:[s.jsx(n.ll,{children:"Price List"}),s.jsx(n.SZ,{children:"View and update pricing history"})]}),(0,s.jsxs)(n.aY,{children:[s.jsx("div",{className:"rounded-md border overflow-hidden",children:(0,s.jsxs)(d.iA,{children:[s.jsx(d.xD,{children:(0,s.jsxs)(d.SC,{children:[s.jsx(d.ss,{children:"Base Price"}),s.jsx(d.ss,{children:"Per KM Price"}),s.jsx(d.ss,{children:"Created"}),s.jsx(d.ss,{children:"Last Updated"}),s.jsx(d.ss,{children:"Updated By"}),s.jsx(d.ss,{className:"text-right",children:"Actions"})]})}),s.jsx(d.RM,{children:B.length>0?B.map(e=>(0,s.jsxs)(d.SC,{children:[(0,s.jsxs)(d.pj,{children:[e.basePrice.toFixed(2)," ETB"]}),(0,s.jsxs)(d.pj,{children:["ETB ",e.perKmPrice.toFixed(2),"/km"]}),s.jsx(d.pj,{children:s.jsx(p.C,{variant:"outline",children:new Date(e.createdAt).toLocaleDateString()})}),s.jsx(d.pj,{children:s.jsx(p.C,{variant:"outline",children:new Date(e.updatedAt).toLocaleDateString()})}),s.jsx(d.pj,{children:(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx(m.Z,{className:"mr-2 h-4 w-4 text-primary"}),e.updatedBy]})}),s.jsx(d.pj,{className:"text-right",children:(0,s.jsxs)(i.z,{variant:"ghost",size:"sm",onClick:()=>Z(e),children:[s.jsx(x.Z,{className:"mr-2 h-4 w-4"}),"Edit"]})})]},e.id)):s.jsx(d.SC,{children:s.jsx(d.pj,{colSpan:6,className:"h-24 text-center",children:"No pricing data found."})})})]})}),_.totalPages>1&&(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-2 pt-4",children:[s.jsx(i.z,{variant:"outline",size:"sm",onClick:()=>E(_.page-1),disabled:1===_.page,children:"Previous"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",_.page," of ",_.totalPages]}),s.jsx(i.z,{variant:"outline",size:"sm",onClick:()=>E(_.page+1),disabled:_.page===_.totalPages,children:"Next"})]})]})]}),s.jsx(o.Vq,{open:f,onOpenChange:j,children:(0,s.jsxs)(o.cZ,{children:[(0,s.jsxs)(o.fK,{children:[s.jsx(o.$N,{children:"Update Pricing"}),s.jsx(o.Be,{children:"Set new base price and per kilometer rate"})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx(c._,{htmlFor:"basePrice",children:"Base Price (ETB)"}),s.jsx(l.I,{id:"basePrice",type:"number",step:"0.01",min:"0",value:v,onChange:e=>N(e.target.value)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx(c._,{htmlFor:"perKmPrice",children:"Per KM Price (ETB)"}),s.jsx(l.I,{id:"perKmPrice",type:"number",step:"0.01",min:"0",value:w,onChange:e=>P(e.target.value)})]})]}),(0,s.jsxs)(o.cN,{children:[s.jsx(i.z,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),s.jsx(i.z,{onClick:A,children:"Save Changes"})]})]})})]})}},62288:(e,a,t)=>{"use strict";t.d(a,{$N:()=>g,Be:()=>h,Vq:()=>d,cN:()=>x,cZ:()=>u,fK:()=>m,hg:()=>o});var s=t(10326),r=t(17577),i=t(73267),n=t(94019),l=t(77863);let d=i.fC,o=r.forwardRef(({className:e,children:a,...t},r)=>s.jsx(i.xz,{ref:r,className:(0,l.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",e),...t,children:a}));o.displayName=i.xz.displayName;let c=i.h_;i.x8;let p=r.forwardRef(({className:e,...a},t)=>s.jsx(i.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a}));p.displayName=i.aV.displayName;let u=r.forwardRef(({className:e,children:a,...t},r)=>(0,s.jsxs)(c,{children:[s.jsx(p,{}),(0,s.jsxs)(i.VY,{ref:r,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[a,(0,s.jsxs)(i.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx(n.Z,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));u.displayName=i.VY.displayName;let m=({className:e,...a})=>s.jsx("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...a});m.displayName="DialogHeader";let x=({className:e,...a})=>s.jsx("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...a});x.displayName="DialogFooter";let g=r.forwardRef(({className:e,...a},t)=>s.jsx(i.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",e),...a}));g.displayName=i.Dx.displayName;let h=r.forwardRef(({className:e,...a},t)=>s.jsx(i.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",e),...a}));h.displayName=i.dk.displayName},92397:(e,a,t)=>{"use strict";t.d(a,{_:()=>p});var s=t(10326),r=t(17577);t(60962);var i=t(34214),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,a)=>{let t=r.forwardRef((e,t)=>{let{asChild:r,...n}=e,l=r?i.g7:a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(l,{...n,ref:t})});return t.displayName=`Primitive.${a}`,{...e,[a]:t}},{}),l=r.forwardRef((e,a)=>(0,s.jsx)(n.label,{...e,ref:a,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));l.displayName="Label";var d=t(79360),o=t(77863);let c=(0,d.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),p=r.forwardRef(({className:e,...a},t)=>s.jsx(l,{ref:t,className:(0,o.cn)(c(),e),...a}));p.displayName=l.displayName},69508:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},79635:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});let s=(0,t(62881).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},24911:(e,a,t)=>{"use strict";function s(){return null}t.r(a),t.d(a,{default:()=>s})},88738:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>s});let s=(0,t(68570).createProxy)(String.raw`C:\Users\hp\Desktop\gibemarket\Moteregna\new\Moteregna\app\dashboard\pricing\page.tsx#default`)}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[216,187,5999,2728,7547],()=>t(84007));module.exports=s})();